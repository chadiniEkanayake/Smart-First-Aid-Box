<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart First Aid Box Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --accent-color: #4fc3f7;
            --danger-color: #e74c3c;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --gray-color: #6c757d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ddd;
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 28px;
        }

        .environment-data {
            display: flex;
            gap: 20px;
        }

        .environment-data div {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 18px;
        }

        .status-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .status-card {
            flex: 1;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-5px);
        }

        .status-card h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .open-time {
            font-size: 14px;
            color: var(--gray-color);
            text-align: center;
        }

        .slots-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .slot-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .slot-card:hover {
            transform: translateY(-5px);
        }

        .slot-card h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary-color);
        }

        .slot-card .weight {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .slot-card .status {
            font-size: 18px;
            font-weight: 500;
            text-align: center;
            padding: 8px;
            border-radius: 5px;
        }

        .alerts-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .alerts-container h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alerts-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .alert-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .alert-item i {
            color: var(--warning-color);
        }

        /* Status colors */
        .status-ok {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success-color);
        }

        .status-full {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }

        .status-empty {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }

        .door-open {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }

        .door-closed {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success-color);
        }

        .buzzer-on {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }

        .buzzer-off {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success-color);
        }

        /* Responsive styles */
        @media (max-width: 768px) {
            .status-container {
                flex-direction: column;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .environment-data {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .slots-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Smart First Aid Box</h1>
            <div class="environment-data">
                <div class="temp">
                    <i class="fas fa-temperature-high"></i>
                    <span id="temperature">--</span>°C
                </div>
                <div class="humidity">
                    <i class="fas fa-tint"></i>
                    <span id="humidity">--</span>%
                </div>
            </div>
        </header>

        <div class="status-container">
            <div class="status-card door-status">
                <h2><i class="fas fa-door-open"></i> Door Status</h2>
                <div class="status-indicator" id="door-status">CLOSED</div>
                <div class="open-time" id="door-time"></div>
            </div>

            <div class="status-card buzzer-status">
                <h2><i class="fas fa-bell"></i> Buzzer</h2>
                <div class="status-indicator" id="buzzer-status">OFF</div>
            </div>
        </div>

        <div class="slots-container">
            <div class="slot-card" id="slot1">
                <h2>Slot 1</h2>
                <div class="weight">
                    <i class="fas fa-weight-hanging"></i>
                    <span id="weight1">--</span> kg
                </div>
                <div class="status" id="status1">OK</div>
            </div>

            <div class="slot-card" id="slot2">
                <h2>Slot 2</h2>
                <div class="weight">
                    <i class="fas fa-weight-hanging"></i>
                    <span id="weight2">--</span> kg
                </div>
                <div class="status" id="status2">OK</div>
            </div>

            <div class="slot-card" id="slot3">
                <h2>Slot 3</h2>
                <div class="weight">
                    <i class="fas fa-weight-hanging"></i>
                    <span id="weight3">--</span> kg
                </div>
                <div class="status" id="status3">OK</div>
            </div>
        </div>

        <div class="alerts-container">
            <h2><i class="fas fa-exclamation-triangle"></i> Alerts</h2>
            <div class="alerts-list" id="alerts-list">
                <!-- Alerts will be added here dynamically -->
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDhyZXmvG779XAH8ivpSCiVgaRyej4Dq4c",
            authDomain: "smart-first-aid-box.firebaseapp.com",
            databaseURL: "https://smart-first-aid-box-default-rtdb.firebaseio.com",
            projectId: "smart-first-aid-box",
            storageBucket: "smart-first-aid-box.appspot.com",
            messagingSenderId: "68639047037",
            appId: "1:68639047037:web:ba28dce257a16fa1bbe014"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // DOM Elements
        const temperatureEl = document.getElementById('temperature');
        const humidityEl = document.getElementById('humidity');
        const doorStatusEl = document.getElementById('door-status');
        const doorTimeEl = document.getElementById('door-time');
        const buzzerStatusEl = document.getElementById('buzzer-status');
        const weight1El = document.getElementById('weight1');
        const weight2El = document.getElementById('weight2');
        const weight3El = document.getElementById('weight3');
        const status1El = document.getElementById('status1');
        const status2El = document.getElementById('status2');
        const status3El = document.getElementById('status3');
        const alertsListEl = document.getElementById('alerts-list');

        // Listen for data changes
        database.ref().on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                updateDashboard(data);
            }
        });

        function updateDashboard(data) {
            // Update environment data
            if (data.environment) {
                temperatureEl.textContent = data.environment.temperature ? data.environment.temperature.toFixed(1) : '--';
                humidityEl.textContent = data.environment.humidity ? data.environment.humidity.toFixed(0) : '--';
            }

            // Update door status
            if (data.door) {
                const doorOpen = data.door.status || false;
                doorStatusEl.textContent = doorOpen ? 'OPEN' : 'CLOSED';
                doorStatusEl.className = 'status-indicator ' + (doorOpen ? 'door-open' : 'door-closed');
            }

            // Update buzzer status
            if (data.door) {
                const buzzerOn = data.door.buzzerOn || false;
                buzzerStatusEl.textContent = buzzerOn ? 'ON' : 'OFF';
                buzzerStatusEl.className = 'status-indicator ' + (buzzerOn ? 'buzzer-on' : 'buzzer-off');
            }

            // Update slot data
            if (data.slots) {
                updateSlot(1, data.slots.slot1);
                updateSlot(2, data.slots.slot2);
                updateSlot(3, data.slots.slot3);
            }

            // Check for alerts
            checkAlerts(data);
        }

        function updateSlot(slotNumber, currentWeight) {
            const weightEl = document.getElementById(`weight${slotNumber}`);
            const statusEl = document.getElementById(`status${slotNumber}`);
            
            if (currentWeight !== undefined) {
                weightEl.textContent = currentWeight.toFixed(1);
                
                if (currentWeight <= 1.0) { // EMPTY_THRESHOLD
                    statusEl.textContent = 'EMPTY';
                    statusEl.className = 'status status-empty';
                } else if (currentWeight >= 30.0) { // FULL_THRESHOLD
                    statusEl.textContent = 'FULL';
                    statusEl.className = 'status status-full';
                } else {
                    statusEl.textContent = 'OK';
                    statusEl.className = 'status status-ok';
                }
            }
        }

        function checkAlerts(data) {
            alertsListEl.innerHTML = ''; // Clear existing alerts
            
            // Check for empty slots
            if (data.slots) {
                if (data.slots.slot1 <= 1.0) {
                    addAlert('Slot 1 is empty!', 'slot1-empty');
                }
                if (data.slots.slot2 <= 1.0) {
                    addAlert('Slot 2 is empty!', 'slot2-empty');
                }
                if (data.slots.slot3 <= 1.0) {
                    addAlert('Slot 3 is empty!', 'slot3-empty');
                }
            }
            
            // Check for temperature/humidity alerts
            if (data.environment) {
                if (data.environment.temperature > 30) {
                    addAlert(`High temperature (${data.environment.temperature.toFixed(1)}°C)!`, 'temp-alert');
                }
                if (data.environment.humidity > 70) {
                    addAlert(`High humidity (${data.environment.humidity.toFixed(0)}%)!`, 'humidity-alert');
                }
            }

            // Check for door open too long
            if (data.door && data.door.status) {
                const openTime = data.door.openTime ? (Date.now() - data.door.openTime) / 1000 : 0;
                if (openTime > 60) {
                    addAlert(`Door has been open for ${Math.floor(openTime)} seconds!`, 'door-alert');
                }
            }
        }

        function addAlert(message, alertClass) {
            const alertItem = document.createElement('div');
            alertItem.className = `alert-item ${alertClass}`;
            alertItem.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
            alertsListEl.prepend(alertItem); // Add to top of list
        }

        // Initialize the dashboard
        updateDashboard({});
    </script>
</body>
</html>